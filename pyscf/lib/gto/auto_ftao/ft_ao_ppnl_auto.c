/*
 * Copyright (C) 2013-  Qiming Sun <osirpt.sun@gmail.com>
 * Copyright (C) 2025-  Christopher Hillenbrand <chillenbrand15@gmail.com>
 * Description: code generated by  gen-code-ft.cl
 */
#include <stdlib.h>
#include <complex.h>
#include "cint.h"
#include "gto/ft_ao.h"


#define G1E_R_I(f, g, li, lj, lk) f = g + bs * envs->g_stride_i;
#define G1E_R_J(f, g, li, lj, lk) f = g + bs * envs->g_stride_j;
#define G1E_R_K(f, g, li, lj, lk) f = g + bs * envs->g_stride_k;

#define G1E_RCI(f, g, li, lj, lk)   GTO_ft_x1i(f, g, dri, li, lj, envs);
#define G1E_RCJ(f, g, li, lj, lk)   GTO_ft_x1j(f, g, drj, li, lj, envs);

#define G1E_R0I(f, g, li, lj, lk)   GTO_ft_x1i(f, g, envs->ri, li, lj, envs);
#define G1E_R0J(f, g, li, lj, lk)   GTO_ft_x1j(f, g, envs->rj, li, lj, envs);

#define ZMAD_MUL(outR, outI, gx, gy, gz, factor) \
        xyR = gx##R[ix*bs+k] * gy##R[iy*bs+k] - gx##I[ix*bs+k] * gy##I[iy*bs+k]; \
        xyI = gx##R[ix*bs+k] * gy##I[iy*bs+k] + gx##I[ix*bs+k] * gy##R[iy*bs+k]; \
        outR += factor * (xyR * gz##R[iz*bs+k] - xyI * gz##I[iz*bs+k]); \
        outI += factor * (xyR * gz##I[iz*bs+k] + xyI * gz##R[iz*bs+k]);

/* <RC i|OVLP |j> */
static void inner_prod_rc(double *gout, double *g, int *idx, FTEnvVars *envs, int empty) {
int nf = envs->nf;
int bs = envs->block_size;
size_t g_size = envs->g_size * bs;
double *g0R = g;
double *g0I = g0R + g_size * 3;
double *g1R = g0I + g_size * 3;
double *g1I = g1R + g_size * 3;
double *goutR = gout;
double *goutI = goutR + nf * bs * 3;
int ix, iy, iz, n, k;
double dri[3];
dri[0] = envs->ri[0] - envs->env[PTR_COMMON_ORIG+0];
dri[1] = envs->ri[1] - envs->env[PTR_COMMON_ORIG+1];
dri[2] = envs->ri[2] - envs->env[PTR_COMMON_ORIG+2];
double xyR, xyI;
G1E_RCI(g1R, g0R, envs->i_l+0, envs->j_l, 0);
G1E_RCI(g1I, g0I, envs->i_l+0, envs->j_l, 0);
if (empty) {
for (n = 0; n < nf; n++) {
ix = idx[0+n*3];
iy = idx[1+n*3];
iz = idx[2+n*3];
#pragma GCC ivdep
for (k = 0; k < bs; k++) {
double sR[3] = {0};
double sI[3] = {0};
ZMAD_MUL(sR[0], sI[0], g1, g0, g0, 1.0);
ZMAD_MUL(sR[1], sI[1], g0, g1, g0, 1.0);
ZMAD_MUL(sR[2], sI[2], g0, g0, g1, 1.0);
goutR[(n*3+0)*bs+k] =  + sR[0];
goutR[(n*3+1)*bs+k] =  + sR[1];
goutR[(n*3+2)*bs+k] =  + sR[2];
goutI[(n*3+0)*bs+k] =  + sI[0];
goutI[(n*3+1)*bs+k] =  + sI[1];
goutI[(n*3+2)*bs+k] =  + sI[2];
}
}
} else {
for (n = 0; n < nf; n++) {
ix = idx[0+n*3];
iy = idx[1+n*3];
iz = idx[2+n*3];
#pragma GCC ivdep
for (k = 0; k < bs; k++) {
double sR[3] = {0};
double sI[3] = {0};
ZMAD_MUL(sR[0], sI[0], g1, g0, g0, 1.0);
ZMAD_MUL(sR[1], sI[1], g0, g1, g0, 1.0);
ZMAD_MUL(sR[2], sI[2], g0, g0, g1, 1.0);
goutR[(n*3+0)*bs+k] +=  + sR[0];
goutR[(n*3+1)*bs+k] +=  + sR[1];
goutR[(n*3+2)*bs+k] +=  + sR[2];
goutI[(n*3+0)*bs+k] +=  + sI[0];
goutI[(n*3+1)*bs+k] +=  + sI[1];
goutI[(n*3+2)*bs+k] +=  + sI[2];
}
}
}}


int GTO_ft_rc_cart(double *outR, double *outI, int *shls, int *dims,
FPtr_eval_gz eval_gz, double complex fac,
double *Gv, double *b, int *gxyz, int *gs, int nGv, int block_size,
int *atm, int natm, int *bas, int nbas, double *env, double *cache) {
int ng[] = {1, 0, 0, 0, 1, 1, 1, 3};
FTEnvVars envs;
GTO_ft_init1e_envs(&envs, ng, shls, fac, Gv, b, gxyz, gs, nGv, block_size, atm, natm, bas, nbas, env);
envs.f_gout = &inner_prod_rc;
return GTO_ft_aopair_drv(outR, outI, dims, eval_gz, cache, &GTO_ft_c2s_cart, &envs);
}

int GTO_ft_rc_sph(double *outR, double *outI, int *shls, int *dims,
FPtr_eval_gz eval_gz, double complex fac,
double *Gv, double *b, int *gxyz, int *gs, int nGv, int block_size,
int *atm, int natm, int *bas, int nbas, double *env, double *cache) {
int ng[] = {1, 0, 0, 0, 1, 1, 1, 3};
FTEnvVars envs;
GTO_ft_init1e_envs(&envs, ng, shls, fac, Gv, b, gxyz, gs, nGv, block_size, atm, natm, bas, nbas, env);
envs.f_gout = &inner_prod_rc;
return GTO_ft_aopair_drv(outR, outI, dims, eval_gz, cache, &GTO_ft_c2s_sph, &envs);
}

/* <RC R DOT R i|OVLP |j> */
static void inner_prod_rc_r2_origi(double *gout, double *g, int *idx, FTEnvVars *envs, int empty) {
int nf = envs->nf;
int bs = envs->block_size;
size_t g_size = envs->g_size * bs;
double *g0R = g;
double *g0I = g0R + g_size * 3;
double *g1R = g0I + g_size * 3;
double *g1I = g1R + g_size * 3;
double *g2R = g1I + g_size * 3;
double *g2I = g2R + g_size * 3;
double *g3R = g2I + g_size * 3;
double *g3I = g3R + g_size * 3;
double *g4R = g3I + g_size * 3;
double *g4I = g4R + g_size * 3;
double *g5R = g4I + g_size * 3;
double *g5I = g5R + g_size * 3;
double *g6R = g5I + g_size * 3;
double *g6I = g6R + g_size * 3;
double *g7R = g6I + g_size * 3;
double *g7I = g7R + g_size * 3;
double *goutR = gout;
double *goutI = goutR + nf * bs * 3;
int ix, iy, iz, n, k;
double dri[3];
dri[0] = envs->ri[0] - envs->env[PTR_COMMON_ORIG+0];
dri[1] = envs->ri[1] - envs->env[PTR_COMMON_ORIG+1];
dri[2] = envs->ri[2] - envs->env[PTR_COMMON_ORIG+2];
double xyR, xyI;
G1E_RCI(g1R, g0R, envs->i_l+2, envs->j_l, 0);
G1E_R_I(g2R, g0R, envs->i_l+1, envs->j_l, 0);
G1E_R_I(g3R, g1R, envs->i_l+1, envs->j_l, 0);
G1E_R_I(g4R, g0R, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g5R, g1R, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g6R, g2R, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g7R, g3R, envs->i_l+0, envs->j_l, 0);
G1E_RCI(g1I, g0I, envs->i_l+2, envs->j_l, 0);
G1E_R_I(g2I, g0I, envs->i_l+1, envs->j_l, 0);
G1E_R_I(g3I, g1I, envs->i_l+1, envs->j_l, 0);
G1E_R_I(g4I, g0I, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g5I, g1I, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g6I, g2I, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g7I, g3I, envs->i_l+0, envs->j_l, 0);
if (empty) {
for (n = 0; n < nf; n++) {
ix = idx[0+n*3];
iy = idx[1+n*3];
iz = idx[2+n*3];
#pragma GCC ivdep
for (k = 0; k < bs; k++) {
double sR[27] = {0};
double sI[27] = {0};
ZMAD_MUL(sR[0], sI[0], g7, g0, g0, 1.0);
ZMAD_MUL(sR[12], sI[12], g1, g6, g0, 1.0);
ZMAD_MUL(sR[24], sI[24], g1, g0, g6, 1.0);
ZMAD_MUL(sR[1], sI[1], g6, g1, g0, 1.0);
ZMAD_MUL(sR[13], sI[13], g0, g7, g0, 1.0);
ZMAD_MUL(sR[25], sI[25], g0, g1, g6, 1.0);
ZMAD_MUL(sR[2], sI[2], g6, g0, g1, 1.0);
ZMAD_MUL(sR[14], sI[14], g0, g6, g1, 1.0);
ZMAD_MUL(sR[26], sI[26], g0, g0, g7, 1.0);
goutR[(n*3+0)*bs+k] =  + sR[0] + sR[12] + sR[24];
goutR[(n*3+1)*bs+k] =  + sR[1] + sR[13] + sR[25];
goutR[(n*3+2)*bs+k] =  + sR[2] + sR[14] + sR[26];
goutI[(n*3+0)*bs+k] =  + sI[0] + sI[12] + sI[24];
goutI[(n*3+1)*bs+k] =  + sI[1] + sI[13] + sI[25];
goutI[(n*3+2)*bs+k] =  + sI[2] + sI[14] + sI[26];
}
}
} else {
for (n = 0; n < nf; n++) {
ix = idx[0+n*3];
iy = idx[1+n*3];
iz = idx[2+n*3];
#pragma GCC ivdep
for (k = 0; k < bs; k++) {
double sR[27] = {0};
double sI[27] = {0};
ZMAD_MUL(sR[0], sI[0], g7, g0, g0, 1.0);
ZMAD_MUL(sR[12], sI[12], g1, g6, g0, 1.0);
ZMAD_MUL(sR[24], sI[24], g1, g0, g6, 1.0);
ZMAD_MUL(sR[1], sI[1], g6, g1, g0, 1.0);
ZMAD_MUL(sR[13], sI[13], g0, g7, g0, 1.0);
ZMAD_MUL(sR[25], sI[25], g0, g1, g6, 1.0);
ZMAD_MUL(sR[2], sI[2], g6, g0, g1, 1.0);
ZMAD_MUL(sR[14], sI[14], g0, g6, g1, 1.0);
ZMAD_MUL(sR[26], sI[26], g0, g0, g7, 1.0);
goutR[(n*3+0)*bs+k] +=  + sR[0] + sR[12] + sR[24];
goutR[(n*3+1)*bs+k] +=  + sR[1] + sR[13] + sR[25];
goutR[(n*3+2)*bs+k] +=  + sR[2] + sR[14] + sR[26];
goutI[(n*3+0)*bs+k] +=  + sI[0] + sI[12] + sI[24];
goutI[(n*3+1)*bs+k] +=  + sI[1] + sI[13] + sI[25];
goutI[(n*3+2)*bs+k] +=  + sI[2] + sI[14] + sI[26];
}
}
}}


int GTO_ft_rc_r2_origi_cart(double *outR, double *outI, int *shls, int *dims,
FPtr_eval_gz eval_gz, double complex fac,
double *Gv, double *b, int *gxyz, int *gs, int nGv, int block_size,
int *atm, int natm, int *bas, int nbas, double *env, double *cache) {
int ng[] = {3, 0, 0, 0, 3, 1, 1, 3};
FTEnvVars envs;
GTO_ft_init1e_envs(&envs, ng, shls, fac, Gv, b, gxyz, gs, nGv, block_size, atm, natm, bas, nbas, env);
envs.f_gout = &inner_prod_rc_r2_origi;
return GTO_ft_aopair_drv(outR, outI, dims, eval_gz, cache, &GTO_ft_c2s_cart, &envs);
}

int GTO_ft_rc_r2_origi_sph(double *outR, double *outI, int *shls, int *dims,
FPtr_eval_gz eval_gz, double complex fac,
double *Gv, double *b, int *gxyz, int *gs, int nGv, int block_size,
int *atm, int natm, int *bas, int nbas, double *env, double *cache) {
int ng[] = {3, 0, 0, 0, 3, 1, 1, 3};
FTEnvVars envs;
GTO_ft_init1e_envs(&envs, ng, shls, fac, Gv, b, gxyz, gs, nGv, block_size, atm, natm, bas, nbas, env);
envs.f_gout = &inner_prod_rc_r2_origi;
return GTO_ft_aopair_drv(outR, outI, dims, eval_gz, cache, &GTO_ft_c2s_sph, &envs);
}

/* <RC R DOT R R DOT R i|OVLP |j> */
static void inner_prod_rc_r4_origi(double *gout, double *g, int *idx, FTEnvVars *envs, int empty) {
int nf = envs->nf;
int bs = envs->block_size;
size_t g_size = envs->g_size * bs;
double *g0R = g;
double *g0I = g0R + g_size * 3;
double *g1R = g0I + g_size * 3;
double *g1I = g1R + g_size * 3;
double *g2R = g1I + g_size * 3;
double *g2I = g2R + g_size * 3;
double *g3R = g2I + g_size * 3;
double *g3I = g3R + g_size * 3;
double *g4R = g3I + g_size * 3;
double *g4I = g4R + g_size * 3;
double *g5R = g4I + g_size * 3;
double *g5I = g5R + g_size * 3;
double *g6R = g5I + g_size * 3;
double *g6I = g6R + g_size * 3;
double *g7R = g6I + g_size * 3;
double *g7I = g7R + g_size * 3;
double *g8R = g7I + g_size * 3;
double *g8I = g8R + g_size * 3;
double *g9R = g8I + g_size * 3;
double *g9I = g9R + g_size * 3;
double *g10R = g9I + g_size * 3;
double *g10I = g10R + g_size * 3;
double *g11R = g10I + g_size * 3;
double *g11I = g11R + g_size * 3;
double *g12R = g11I + g_size * 3;
double *g12I = g12R + g_size * 3;
double *g13R = g12I + g_size * 3;
double *g13I = g13R + g_size * 3;
double *g14R = g13I + g_size * 3;
double *g14I = g14R + g_size * 3;
double *g15R = g14I + g_size * 3;
double *g15I = g15R + g_size * 3;
double *g16R = g15I + g_size * 3;
double *g16I = g16R + g_size * 3;
double *g17R = g16I + g_size * 3;
double *g17I = g17R + g_size * 3;
double *g18R = g17I + g_size * 3;
double *g18I = g18R + g_size * 3;
double *g19R = g18I + g_size * 3;
double *g19I = g19R + g_size * 3;
double *g20R = g19I + g_size * 3;
double *g20I = g20R + g_size * 3;
double *g21R = g20I + g_size * 3;
double *g21I = g21R + g_size * 3;
double *g22R = g21I + g_size * 3;
double *g22I = g22R + g_size * 3;
double *g23R = g22I + g_size * 3;
double *g23I = g23R + g_size * 3;
double *g24R = g23I + g_size * 3;
double *g24I = g24R + g_size * 3;
double *g25R = g24I + g_size * 3;
double *g25I = g25R + g_size * 3;
double *g26R = g25I + g_size * 3;
double *g26I = g26R + g_size * 3;
double *g27R = g26I + g_size * 3;
double *g27I = g27R + g_size * 3;
double *g28R = g27I + g_size * 3;
double *g28I = g28R + g_size * 3;
double *g29R = g28I + g_size * 3;
double *g29I = g29R + g_size * 3;
double *g30R = g29I + g_size * 3;
double *g30I = g30R + g_size * 3;
double *g31R = g30I + g_size * 3;
double *g31I = g31R + g_size * 3;
double *goutR = gout;
double *goutI = goutR + nf * bs * 3;
int ix, iy, iz, n, k;
double dri[3];
dri[0] = envs->ri[0] - envs->env[PTR_COMMON_ORIG+0];
dri[1] = envs->ri[1] - envs->env[PTR_COMMON_ORIG+1];
dri[2] = envs->ri[2] - envs->env[PTR_COMMON_ORIG+2];
double xyR, xyI;
G1E_RCI(g1R, g0R, envs->i_l+4, envs->j_l, 0);
G1E_R_I(g2R, g0R, envs->i_l+3, envs->j_l, 0);
G1E_R_I(g3R, g1R, envs->i_l+3, envs->j_l, 0);
G1E_R_I(g4R, g0R, envs->i_l+2, envs->j_l, 0);
G1E_R_I(g5R, g1R, envs->i_l+2, envs->j_l, 0);
G1E_R_I(g6R, g2R, envs->i_l+2, envs->j_l, 0);
G1E_R_I(g7R, g3R, envs->i_l+2, envs->j_l, 0);
G1E_R_I(g8R, g0R, envs->i_l+1, envs->j_l, 0);
G1E_R_I(g9R, g1R, envs->i_l+1, envs->j_l, 0);
G1E_R_I(g10R, g2R, envs->i_l+1, envs->j_l, 0);
G1E_R_I(g11R, g3R, envs->i_l+1, envs->j_l, 0);
G1E_R_I(g12R, g4R, envs->i_l+1, envs->j_l, 0);
G1E_R_I(g13R, g5R, envs->i_l+1, envs->j_l, 0);
G1E_R_I(g14R, g6R, envs->i_l+1, envs->j_l, 0);
G1E_R_I(g15R, g7R, envs->i_l+1, envs->j_l, 0);
G1E_R_I(g16R, g0R, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g17R, g1R, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g18R, g2R, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g19R, g3R, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g20R, g4R, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g21R, g5R, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g22R, g6R, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g23R, g7R, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g24R, g8R, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g25R, g9R, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g26R, g10R, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g27R, g11R, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g28R, g12R, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g29R, g13R, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g30R, g14R, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g31R, g15R, envs->i_l+0, envs->j_l, 0);
G1E_RCI(g1I, g0I, envs->i_l+4, envs->j_l, 0);
G1E_R_I(g2I, g0I, envs->i_l+3, envs->j_l, 0);
G1E_R_I(g3I, g1I, envs->i_l+3, envs->j_l, 0);
G1E_R_I(g4I, g0I, envs->i_l+2, envs->j_l, 0);
G1E_R_I(g5I, g1I, envs->i_l+2, envs->j_l, 0);
G1E_R_I(g6I, g2I, envs->i_l+2, envs->j_l, 0);
G1E_R_I(g7I, g3I, envs->i_l+2, envs->j_l, 0);
G1E_R_I(g8I, g0I, envs->i_l+1, envs->j_l, 0);
G1E_R_I(g9I, g1I, envs->i_l+1, envs->j_l, 0);
G1E_R_I(g10I, g2I, envs->i_l+1, envs->j_l, 0);
G1E_R_I(g11I, g3I, envs->i_l+1, envs->j_l, 0);
G1E_R_I(g12I, g4I, envs->i_l+1, envs->j_l, 0);
G1E_R_I(g13I, g5I, envs->i_l+1, envs->j_l, 0);
G1E_R_I(g14I, g6I, envs->i_l+1, envs->j_l, 0);
G1E_R_I(g15I, g7I, envs->i_l+1, envs->j_l, 0);
G1E_R_I(g16I, g0I, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g17I, g1I, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g18I, g2I, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g19I, g3I, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g20I, g4I, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g21I, g5I, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g22I, g6I, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g23I, g7I, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g24I, g8I, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g25I, g9I, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g26I, g10I, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g27I, g11I, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g28I, g12I, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g29I, g13I, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g30I, g14I, envs->i_l+0, envs->j_l, 0);
G1E_R_I(g31I, g15I, envs->i_l+0, envs->j_l, 0);
if (empty) {
for (n = 0; n < nf; n++) {
ix = idx[0+n*3];
iy = idx[1+n*3];
iz = idx[2+n*3];
#pragma GCC ivdep
for (k = 0; k < bs; k++) {
double sR[243] = {0};
double sI[243] = {0};
ZMAD_MUL(sR[0], sI[0], g31, g0, g0, 1.0);
ZMAD_MUL(sR[12], sI[12], g25, g6, g0, 2.0);
ZMAD_MUL(sR[24], sI[24], g25, g0, g6, 2.0);
ZMAD_MUL(sR[120], sI[120], g1, g30, g0, 1.0);
ZMAD_MUL(sR[132], sI[132], g1, g24, g6, 2.0);
ZMAD_MUL(sR[240], sI[240], g1, g0, g30, 1.0);
ZMAD_MUL(sR[1], sI[1], g30, g1, g0, 1.0);
ZMAD_MUL(sR[13], sI[13], g24, g7, g0, 2.0);
ZMAD_MUL(sR[25], sI[25], g24, g1, g6, 2.0);
ZMAD_MUL(sR[121], sI[121], g0, g31, g0, 1.0);
ZMAD_MUL(sR[133], sI[133], g0, g25, g6, 2.0);
ZMAD_MUL(sR[241], sI[241], g0, g1, g30, 1.0);
ZMAD_MUL(sR[2], sI[2], g30, g0, g1, 1.0);
ZMAD_MUL(sR[14], sI[14], g24, g6, g1, 2.0);
ZMAD_MUL(sR[26], sI[26], g24, g0, g7, 2.0);
ZMAD_MUL(sR[122], sI[122], g0, g30, g1, 1.0);
ZMAD_MUL(sR[134], sI[134], g0, g24, g7, 2.0);
ZMAD_MUL(sR[242], sI[242], g0, g0, g31, 1.0);
goutR[(n*3+0)*bs+k] =  + sR[0] + sR[12] + sR[24] + sR[120] + sR[132] + sR[240];
goutR[(n*3+1)*bs+k] =  + sR[1] + sR[13] + sR[25] + sR[121] + sR[133] + sR[241];
goutR[(n*3+2)*bs+k] =  + sR[2] + sR[14] + sR[26] + sR[122] + sR[134] + sR[242];
goutI[(n*3+0)*bs+k] =  + sI[0] + sI[12] + sI[24] + sI[120] + sI[132] + sI[240];
goutI[(n*3+1)*bs+k] =  + sI[1] + sI[13] + sI[25] + sI[121] + sI[133] + sI[241];
goutI[(n*3+2)*bs+k] =  + sI[2] + sI[14] + sI[26] + sI[122] + sI[134] + sI[242];
}
}
} else {
for (n = 0; n < nf; n++) {
ix = idx[0+n*3];
iy = idx[1+n*3];
iz = idx[2+n*3];
#pragma GCC ivdep
for (k = 0; k < bs; k++) {
double sR[243] = {0};
double sI[243] = {0};
ZMAD_MUL(sR[0], sI[0], g31, g0, g0, 1.0);
ZMAD_MUL(sR[12], sI[12], g25, g6, g0, 2.0);
ZMAD_MUL(sR[24], sI[24], g25, g0, g6, 2.0);
ZMAD_MUL(sR[120], sI[120], g1, g30, g0, 1.0);
ZMAD_MUL(sR[132], sI[132], g1, g24, g6, 2.0);
ZMAD_MUL(sR[240], sI[240], g1, g0, g30, 1.0);
ZMAD_MUL(sR[1], sI[1], g30, g1, g0, 1.0);
ZMAD_MUL(sR[13], sI[13], g24, g7, g0, 2.0);
ZMAD_MUL(sR[25], sI[25], g24, g1, g6, 2.0);
ZMAD_MUL(sR[121], sI[121], g0, g31, g0, 1.0);
ZMAD_MUL(sR[133], sI[133], g0, g25, g6, 2.0);
ZMAD_MUL(sR[241], sI[241], g0, g1, g30, 1.0);
ZMAD_MUL(sR[2], sI[2], g30, g0, g1, 1.0);
ZMAD_MUL(sR[14], sI[14], g24, g6, g1, 2.0);
ZMAD_MUL(sR[26], sI[26], g24, g0, g7, 2.0);
ZMAD_MUL(sR[122], sI[122], g0, g30, g1, 1.0);
ZMAD_MUL(sR[134], sI[134], g0, g24, g7, 2.0);
ZMAD_MUL(sR[242], sI[242], g0, g0, g31, 1.0);
goutR[(n*3+0)*bs+k] +=  + sR[0] + sR[12] + sR[24] + sR[120] + sR[132] + sR[240];
goutR[(n*3+1)*bs+k] +=  + sR[1] + sR[13] + sR[25] + sR[121] + sR[133] + sR[241];
goutR[(n*3+2)*bs+k] +=  + sR[2] + sR[14] + sR[26] + sR[122] + sR[134] + sR[242];
goutI[(n*3+0)*bs+k] +=  + sI[0] + sI[12] + sI[24] + sI[120] + sI[132] + sI[240];
goutI[(n*3+1)*bs+k] +=  + sI[1] + sI[13] + sI[25] + sI[121] + sI[133] + sI[241];
goutI[(n*3+2)*bs+k] +=  + sI[2] + sI[14] + sI[26] + sI[122] + sI[134] + sI[242];
}
}
}}


int GTO_ft_rc_r4_origi_cart(double *outR, double *outI, int *shls, int *dims,
FPtr_eval_gz eval_gz, double complex fac,
double *Gv, double *b, int *gxyz, int *gs, int nGv, int block_size,
int *atm, int natm, int *bas, int nbas, double *env, double *cache) {
int ng[] = {5, 0, 0, 0, 5, 1, 1, 3};
FTEnvVars envs;
GTO_ft_init1e_envs(&envs, ng, shls, fac, Gv, b, gxyz, gs, nGv, block_size, atm, natm, bas, nbas, env);
envs.f_gout = &inner_prod_rc_r4_origi;
return GTO_ft_aopair_drv(outR, outI, dims, eval_gz, cache, &GTO_ft_c2s_cart, &envs);
}

int GTO_ft_rc_r4_origi_sph(double *outR, double *outI, int *shls, int *dims,
FPtr_eval_gz eval_gz, double complex fac,
double *Gv, double *b, int *gxyz, int *gs, int nGv, int block_size,
int *atm, int natm, int *bas, int nbas, double *env, double *cache) {
int ng[] = {5, 0, 0, 0, 5, 1, 1, 3};
FTEnvVars envs;
GTO_ft_init1e_envs(&envs, ng, shls, fac, Gv, b, gxyz, gs, nGv, block_size, atm, natm, bas, nbas, env);
envs.f_gout = &inner_prod_rc_r4_origi;
return GTO_ft_aopair_drv(outR, outI, dims, eval_gz, cache, &GTO_ft_c2s_sph, &envs);
}

